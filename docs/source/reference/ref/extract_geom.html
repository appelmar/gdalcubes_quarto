<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.9.238">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>gdalcubes – extract_geom</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
  <script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
  <script src="../../../site_libs/clipboard/clipboard.min.js"></script>
  <meta name="quarto:offset" content="../../../">
  <script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
  <script src="../../../site_libs/quarto-search/fuse.min.js"></script>
  <script src="../../../site_libs/quarto-search/quarto-search.js"></script>
  <link href="../../../favicon.png" rel="icon" type="image/png">
  <script src="../../../site_libs/quarto-html/quarto.js"></script>
  <script src="../../../site_libs/quarto-html/popper.min.js"></script>
  <script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
  <script src="../../../site_libs/quarto-html/anchor.min.js"></script>
  <link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
  <link id="quarto-text-highlighting-styles" href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
  <link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <script id="quarto-search-options" type="application/json">{
    "location": "navbar",
    "copy-button": false,
    "collapse-after": 3,
    "panel-placement": "end",
    "type": "overlay",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <link rel="stylesheet" href="../../../styles.css">
</head>
<body class="floating nav-fixed">
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../../index.html">
    <img src="../../../source/gdalcubes_logo_mini.png" alt="">
    <span class="navbar-title">gdalcubes</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../source/getstarted.html">Get started</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../source/introduction/why.html">Overview</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../source/tutorials/index.html">Tutorials</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../../source/reference/index.html" aria-current="page">Reference</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-help" role="button" data-bs-toggle="dropdown" aria-expanded="false">Help</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-help">    
        <li>
    <a class="dropdown-item" href="https://github.com/appelmar/gdalcubes_R"><i class="bi bi-github" role="img">
</i> 
 <span class="dropdown-text">Source code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/appelmar/gdalcubes_R/issues"><i class="bi bi-bug" role="img">
</i> 
 <span class="dropdown-text">Report an issue</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../source/introduction/faq.html"><i class="bi bi-question-circle" role="img">
</i> 
 <span class="dropdown-text">FAQ</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../../source/about.html">About</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/appelmar/gdalcubes_R"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">(Untitled)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/index.html" class="sidebar-item-text sidebar-link">Reference</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">Image collections</a>
      <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/add_images.html" class="sidebar-item-text sidebar-link">add_images</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/add_collection_format.html" class="sidebar-item-text sidebar-link">add_collection_format</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/create_image_collection.html" class="sidebar-item-text sidebar-link">create_image_collection</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/collection_formats.html" class="sidebar-item-text sidebar-link">collection_formats</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/extent.html" class="sidebar-item-text sidebar-link">extent</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/stac_image_collection.html" class="sidebar-item-text sidebar-link">stac_image_collection</a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Data cube creation</a>
      <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/cube_view.html" class="sidebar-item-text sidebar-link">cube_view</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/image_mask.html" class="sidebar-item-text sidebar-link">image_mask</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/json_cube.html" class="sidebar-item-text sidebar-link">json_cube</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/ncdf_cube.html" class="sidebar-item-text sidebar-link">ncdf_cube</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/raster_cube.html" class="sidebar-item-text sidebar-link">raster_cube</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/stack_cube.html" class="sidebar-item-text sidebar-link">stack_cube</a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Data cube properties</a>
      <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/bands.html" class="sidebar-item-text sidebar-link">bands</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/dim.cube.html" class="sidebar-item-text sidebar-link">dim.cube</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/dimension_bounds.html" class="sidebar-item-text sidebar-link">dimension_bounds</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/dimensions.html" class="sidebar-item-text sidebar-link">dimensions</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/dimension_values.html" class="sidebar-item-text sidebar-link">dimension_values</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/names.cube.html" class="sidebar-item-text sidebar-link">names.cube</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/nbands.html" class="sidebar-item-text sidebar-link">nbands</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/nt.html" class="sidebar-item-text sidebar-link">nt</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/nx.html" class="sidebar-item-text sidebar-link">nx</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/ny.html" class="sidebar-item-text sidebar-link">ny</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/size.html" class="sidebar-item-text sidebar-link">size</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/srs.html" class="sidebar-item-text sidebar-link">srs</a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Data cube operations</a>
      <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/aggregate_space.html" class="sidebar-item-text sidebar-link">aggregate_space</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/aggregate_time.html" class="sidebar-item-text sidebar-link">aggregate_time</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/apply_pixel.cube.html" class="sidebar-item-text sidebar-link">apply_pixel.cube</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/apply_time.cube.html" class="sidebar-item-text sidebar-link">apply_time.cube</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/crop.html" class="sidebar-item-text sidebar-link">crop</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/extract_geom.html" class="sidebar-item-text sidebar-link active">extract_geom</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/fill_time.html" class="sidebar-item-text sidebar-link">fill_time</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/filter_geom.html" class="sidebar-item-text sidebar-link">filter_geom</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/filter_pixel.html" class="sidebar-item-text sidebar-link">filter_pixel</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/gdalcubes_selection.html" class="sidebar-item-text sidebar-link">gdalcubes_selection</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/join_bands.html" class="sidebar-item-text sidebar-link">join_bands</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/reduce_space.cube.html" class="sidebar-item-text sidebar-link">reduce_space.cube</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/reduce_time.cube.html" class="sidebar-item-text sidebar-link">reduce_time.cube</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/select_bands.html" class="sidebar-item-text sidebar-link">select_bands</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/select_time.html" class="sidebar-item-text sidebar-link">select_time</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/slice_space.html" class="sidebar-item-text sidebar-link">slice_space</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/slice_time.html" class="sidebar-item-text sidebar-link">slice_time</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/window_time.html" class="sidebar-item-text sidebar-link">window_time</a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">Export / visualization</a>
      <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/animate.html" class="sidebar-item-text sidebar-link">animate</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/as_array.html" class="sidebar-item-text sidebar-link">as_array</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/as_json.html" class="sidebar-item-text sidebar-link">as_json</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/extract_geom.html" class="sidebar-item-text sidebar-link">extract_geom</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/pack_minmax.html" class="sidebar-item-text sidebar-link">pack_minmax</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/plot.cube.html" class="sidebar-item-text sidebar-link">plot.cube</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/st_as_stars.cube.html" class="sidebar-item-text sidebar-link">st_as_stars.cube</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/write_ncdf.html" class="sidebar-item-text sidebar-link">write_ncdf</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/write_tif.html" class="sidebar-item-text sidebar-link">write_tif</a>
  </div>
</li>
    </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
    <div class="sidebar-item-container"> 
        <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">Miscellaneous</a>
      <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
        <i class="bi bi-chevron-right ms-2"></i>
      </a>
    </div>
    <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/gdalcubes_options.html" class="sidebar-item-text sidebar-link">gdalcubes_options</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/gdalcubes_set_gdal_config.html" class="sidebar-item-text sidebar-link">gdalcubes_set_gdal_config</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/gdalcubes_gdalformats.html" class="sidebar-item-text sidebar-link">gdalcubes_gdalformats</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../source/reference/ref/gdalcubes_gdalversion.html" class="sidebar-item-text sidebar-link">gdalcubes_gdalversion</a>
  </div>
</li>
    </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
<ul>
<li><a href="#extract_geom" id="toc-extract_geom" class="nav-link active" data-scroll-target="#extract_geom">extract_geom</a>
<ul class="collapse">
<li><a href="#description" id="toc-description" class="nav-link" data-scroll-target="#description">Description</a></li>
<li><a href="#usage" id="toc-usage" class="nav-link" data-scroll-target="#usage">Usage</a></li>
<li><a href="#arguments" id="toc-arguments" class="nav-link" data-scroll-target="#arguments">Arguments</a></li>
<li><a href="#details" id="toc-details" class="nav-link" data-scroll-target="#details">Details</a></li>
<li><a href="#value" id="toc-value" class="nav-link" data-scroll-target="#value">Value</a></li>
<li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a></li>
</ul></li>
</ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<section id="extract_geom" class="level1">
<h1>extract_geom</h1>
<p>Extract values from a data cube by spatial or spatiotemporal features</p>
<section id="description" class="level2">
<h2 class="anchored" data-anchor-id="description">Description</h2>
<p>Extract pixel values of a data cube from a set of spatial or spatiotemporal features. Applications include the extraction of full time series at irregular points, extraction from spatiotemporal points, extraction of pixel values in polygons, and computing summary statistics over polygons.</p>
</section>
<section id="usage" class="level2">
<h2 class="anchored" data-anchor-id="usage">Usage</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">extract_geom</span>(</span>
<span id="cb1-2"><a href="#cb1-2"></a>  cube,</span>
<span id="cb1-3"><a href="#cb1-3"></a>  sf,</span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="at">datetime =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="at">time_column =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="at">FUN =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-7"><a href="#cb1-7"></a>  ...,</span>
<span id="cb1-8"><a href="#cb1-8"></a>  <span class="at">reduce_time =</span> <span class="cn">FALSE</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="arguments" class="level2">
<h2 class="anchored" data-anchor-id="arguments">Arguments</h2>
<table class="table">
<colgroup>
<col style="width: 27%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Argument</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">cube</td>
<td style="text-align: left;">source data cube to extract values from</td>
</tr>
<tr class="even">
<td style="text-align: left;">sf</td>
<td style="text-align: left;">object of class <code>sf</code>, see [sf package](<a href="https://r-spatial.github.io/sf/reference/st_as_sf.html">sf::st_as_sf</a>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">datetime</td>
<td style="text-align: left;">Date, POSIXt, or character vector containing per feature time information; length must be identical to the number of features in <code>sf</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">time_column</td>
<td style="text-align: left;">name of the column in <code>sf</code> containing per feature time information</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FUN</td>
<td style="text-align: left;">optional function to compute per feature summary statistics</td>
</tr>
<tr class="even">
<td style="text-align: left;">…</td>
<td style="text-align: left;">additional arguments passed to <code>FUN</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">reduce_time</td>
<td style="text-align: left;">logical; if TRUE, time is ignored when <code>FUN</code> is applied</td>
</tr>
</tbody>
</table>
</section>
<section id="details" class="level2">
<h2 class="anchored" data-anchor-id="details">Details</h2>
<p>The geometry in <code>sf</code> can be of any simple feature type supported by GDAL, including POINTS, LINES, POLYGONS, MULTI*, and more. If no time information is provided in one of the arguments <code>datetime</code> or <code>time_column</code>, the full time series of pixels with regard to the features are returned.</p>
<p>Pixels with missing values are automatically dropped from the result. It is hence not guaranteed that the result will contain rows for all input features.</p>
<p>Features are automatically reprojected if the coordinate reference system differs from the data cube.</p>
<p>Extracted values can be aggregated by features by providing a summary function. If <code>reduce_time</code> is FALSE (the default), the values are grouped by feature and time, i.e., the result will contain unique combinations of FID and time. To ignore time and produce a single value per feature, <code>reduce_time</code> can be set to TRUE.</p>
</section>
<section id="value" class="level2">
<h2 class="anchored" data-anchor-id="value">Value</h2>
<p>A data.frame with columns FID, time, and data cube bands / variables</p>
</section>
<section id="examples" class="level2">
<h2 class="anchored" data-anchor-id="examples">Examples</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># if not already done in other examples</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">"L8.db"</span>))) {</span>
<span id="cb2-3"><a href="#cb2-3"></a>  L8_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">system.file</span>(<span class="st">"L8NY18"</span>, <span class="at">package =</span> <span class="st">"gdalcubes"</span>),</span>
<span id="cb2-4"><a href="#cb2-4"></a>                         <span class="st">".TIF"</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="fu">create_image_collection</span>(L8_files, <span class="st">"L8_L1TP"</span>, <span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">"L8.db"</span>), <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a>}</span>
<span id="cb2-7"><a href="#cb2-7"></a>L8.col <span class="ot">=</span> <span class="fu">image_collection</span>(<span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">"L8.db"</span>))</span>
<span id="cb2-8"><a href="#cb2-8"></a>v <span class="ot">=</span> <span class="fu">cube_view</span>(<span class="at">srs=</span><span class="st">"EPSG:32618"</span>, <span class="at">dy=</span><span class="dv">1000</span>, <span class="at">dx=</span><span class="dv">1000</span>, <span class="at">dt=</span><span class="st">"P1M"</span>,</span>
<span id="cb2-9"><a href="#cb2-9"></a>              <span class="at">aggregation =</span> <span class="st">"median"</span>, <span class="at">resampling =</span> <span class="st">"bilinear"</span>,</span>
<span id="cb2-10"><a href="#cb2-10"></a>              <span class="at">extent=</span><span class="fu">list</span>(<span class="at">left=</span><span class="fl">388941.2</span>, <span class="at">right=</span><span class="fl">766552.4</span>,</span>
<span id="cb2-11"><a href="#cb2-11"></a>                          <span class="at">bottom=</span><span class="dv">4345299</span>, <span class="at">top=</span><span class="dv">4744931</span>,</span>
<span id="cb2-12"><a href="#cb2-12"></a>                          <span class="at">t0=</span><span class="st">"2018-01-01"</span>, <span class="at">t1=</span><span class="st">"2018-04-30"</span>))</span>
<span id="cb2-13"><a href="#cb2-13"></a>L8.cube <span class="ot">=</span> <span class="fu">raster_cube</span>(L8.col, v)</span>
<span id="cb2-14"><a href="#cb2-14"></a>L8.cube <span class="ot">=</span> <span class="fu">select_bands</span>(L8.cube, <span class="fu">c</span>(<span class="st">"B04"</span>, <span class="st">"B05"</span>))</span>
<span id="cb2-15"><a href="#cb2-15"></a>L8.ndvi <span class="ot">=</span> <span class="fu">apply_pixel</span>(L8.cube, <span class="st">"(B05-B04)/(B05+B04)"</span>, <span class="st">"NDVI"</span>)</span>
<span id="cb2-16"><a href="#cb2-16"></a>L8.ndvi</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A GDAL data cube proxy object

Dimensions:
         low       high count pixel_size chunk_size
t 2018-01-01 2018-04-30     4        P1M          1
y    4345115    4745115   400       1000        320
x   388746.8   766746.8   378       1000        320

Bands:
  name offset scale nodata unit
1 NDVI      0     1    NaN     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="cf">if</span> (<span class="fu">gdalcubes_gdal_has_geos</span>()) {</span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"sf"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb4-3"><a href="#cb4-3"></a>  </span>
<span id="cb4-4"><a href="#cb4-4"></a>    x <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">20</span>, v<span class="sc">$</span>space<span class="sc">$</span>left, v<span class="sc">$</span>space<span class="sc">$</span>right)</span>
<span id="cb4-5"><a href="#cb4-5"></a>    y <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">20</span>, v<span class="sc">$</span>space<span class="sc">$</span>bottom, v<span class="sc">$</span>space<span class="sc">$</span>top)</span>
<span id="cb4-6"><a href="#cb4-6"></a>    t <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2018-01-01"</span>),<span class="fu">as.Date</span>(<span class="st">"2018-04-30"</span>), <span class="at">by =</span> <span class="dv">1</span>),<span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a>    df <span class="ot">=</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>), <span class="at">crs =</span> v<span class="sc">$</span>space<span class="sc">$</span>srs)</span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a>    <span class="co"># spatiotemporal points</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>    <span class="fu">extract_geom</span>(L8.ndvi, df, <span class="at">datetime =</span> t)</span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a>    <span class="co"># time series at spatial points</span></span>
<span id="cb4-13"><a href="#cb4-13"></a>    <span class="fu">extract_geom</span>(L8.ndvi, df)</span>
<span id="cb4-14"><a href="#cb4-14"></a>  </span>
<span id="cb4-15"><a href="#cb4-15"></a>    <span class="co"># summary statistics over polygons</span></span>
<span id="cb4-16"><a href="#cb4-16"></a>    x <span class="ot">=</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="fu">system.file</span>(<span class="st">"nycd.gpkg"</span>, <span class="at">package =</span> <span class="st">"gdalcubes"</span>))</span>
<span id="cb4-17"><a href="#cb4-17"></a>    zstats <span class="ot">=</span> <span class="fu">extract_geom</span>(L8.ndvi,x, <span class="at">FUN=</span>median, <span class="at">reduce_time =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-18"><a href="#cb4-18"></a>    zstats</span>
<span id="cb4-19"><a href="#cb4-19"></a>    <span class="co"># combine with original sf object</span></span>
<span id="cb4-20"><a href="#cb4-20"></a>    x<span class="sc">$</span>FID <span class="ot">=</span> <span class="fu">rownames</span>(x)</span>
<span id="cb4-21"><a href="#cb4-21"></a>    x <span class="ot">=</span> <span class="fu">merge</span>(x, zstats, <span class="at">by =</span> <span class="st">"FID"</span>)</span>
<span id="cb4-22"><a href="#cb4-22"></a>    x</span>
<span id="cb4-23"><a href="#cb4-23"></a>    <span class="co"># plot(x["NDVI"])</span></span>
<span id="cb4-24"><a href="#cb4-24"></a>  }</span>
<span id="cb4-25"><a href="#cb4-25"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `nycd_1' from data source 
  `/home/marius/R/x86_64-pc-linux-gnu-library/4.1/gdalcubes/nycd.gpkg' 
  using driver `GPKG'
Simple feature collection with 71 features and 0 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 563069.9 ymin: 4483098 xmax: 609761.1 ymax: 4529895
Projected CRS: WGS 84 / UTM zone 18N</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 71 features and 2 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 563069.9 ymin: 4483098 xmax: 609761.1 ymax: 4529895
Projected CRS: WGS 84 / UTM zone 18N
First 10 features:
   FID        NDVI                       geometry
1    1 0.026432508 MULTIPOLYGON (((586882.1 44...
2   10 0.034696086 MULTIPOLYGON (((597308.6 45...
3   11 0.028883248 MULTIPOLYGON (((592617.7 45...
4   12 0.066547940 MULTIPOLYGON (((601288 4502...
5   13 0.071926794 MULTIPOLYGON (((593921.5 45...
6   14 0.021659255 MULTIPOLYGON (((593432.1 45...
7   15 0.031520287 MULTIPOLYGON (((594782.6 45...
8   16 0.068065497 MULTIPOLYGON (((598329 4507...
9   17 0.033419028 MULTIPOLYGON (((591557.1 44...
10  18 0.004027017 MULTIPOLYGON (((586678.7 45...</code></pre>
</div>
</div>



<!-- -->

</section>
</section>
</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb7" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu"># extract_geom</span></span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a>Extract values from a data cube by spatial or spatiotemporal features</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="in">```{r include=FALSE}</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="fu">library</span>(gdalcubes)</span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="in">```</span></span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="fu">## Description</span></span>
<span id="cb7-12"><a href="#cb7-12"></a></span>
<span id="cb7-13"><a href="#cb7-13"></a>Extract pixel values of a data cube from a set of spatial or spatiotemporal features. </span>
<span id="cb7-14"><a href="#cb7-14"></a>Applications include the extraction of full time </span>
<span id="cb7-15"><a href="#cb7-15"></a>series at irregular points, extraction from spatiotemporal points, extraction of</span>
<span id="cb7-16"><a href="#cb7-16"></a>pixel values in polygons, and computing summary statistics over polygons.</span>
<span id="cb7-17"><a href="#cb7-17"></a></span>
<span id="cb7-18"><a href="#cb7-18"></a></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="fu">## Usage</span></span>
<span id="cb7-20"><a href="#cb7-20"></a></span>
<span id="cb7-21"><a href="#cb7-21"></a></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="in">```r</span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="fu">extract_geom</span>(</span>
<span id="cb7-24"><a href="#cb7-24"></a>  cube,</span>
<span id="cb7-25"><a href="#cb7-25"></a>  sf,</span>
<span id="cb7-26"><a href="#cb7-26"></a>  <span class="at">datetime =</span> <span class="cn">NULL</span>,</span>
<span id="cb7-27"><a href="#cb7-27"></a>  <span class="at">time_column =</span> <span class="cn">NULL</span>,</span>
<span id="cb7-28"><a href="#cb7-28"></a>  <span class="at">FUN =</span> <span class="cn">NULL</span>,</span>
<span id="cb7-29"><a href="#cb7-29"></a>  ...,</span>
<span id="cb7-30"><a href="#cb7-30"></a>  <span class="at">reduce_time =</span> <span class="cn">FALSE</span></span>
<span id="cb7-31"><a href="#cb7-31"></a>)</span>
<span id="cb7-32"><a href="#cb7-32"></a></span>
<span id="cb7-33"><a href="#cb7-33"></a><span class="in">```</span></span>
<span id="cb7-34"><a href="#cb7-34"></a></span>
<span id="cb7-35"><a href="#cb7-35"></a></span>
<span id="cb7-36"><a href="#cb7-36"></a><span class="fu">## Arguments</span></span>
<span id="cb7-37"><a href="#cb7-37"></a></span>
<span id="cb7-38"><a href="#cb7-38"></a>| Argument    | Description                       |</span>
<span id="cb7-39"><a href="#cb7-39"></a>|:------------|:----------------------------------|</span>
<span id="cb7-40"><a href="#cb7-40"></a>| cube | source data cube to extract values from |</span>
<span id="cb7-41"><a href="#cb7-41"></a>| sf | object of class <span class="in">`sf`</span>, see <span class="co">[</span><span class="ot">sf package</span><span class="co">](&lt;a href='https://r-spatial.github.io/sf/reference/st_as_sf.html'&gt;sf::st_as_sf&lt;/a&gt;)</span> |</span>
<span id="cb7-42"><a href="#cb7-42"></a>| datetime | Date, POSIXt, or character vector containing per feature time information; length must be identical to the number of features in <span class="in">`sf`</span> |</span>
<span id="cb7-43"><a href="#cb7-43"></a>| time_column | name of the column in <span class="in">`sf`</span> containing per feature time information |</span>
<span id="cb7-44"><a href="#cb7-44"></a>| FUN | optional function to compute per feature summary statistics |</span>
<span id="cb7-45"><a href="#cb7-45"></a>| ... | additional arguments passed to <span class="in">`FUN`</span> |</span>
<span id="cb7-46"><a href="#cb7-46"></a>| reduce_time | logical; if TRUE, time is ignored when <span class="in">`FUN`</span> is applied |</span>
<span id="cb7-47"><a href="#cb7-47"></a></span>
<span id="cb7-48"><a href="#cb7-48"></a></span>
<span id="cb7-49"><a href="#cb7-49"></a><span class="fu">## Details</span></span>
<span id="cb7-50"><a href="#cb7-50"></a></span>
<span id="cb7-51"><a href="#cb7-51"></a>The geometry in <span class="in">`sf`</span> can be of any simple feature type supported by GDAL, including </span>
<span id="cb7-52"><a href="#cb7-52"></a>POINTS, LINES, POLYGONS, MULTI*, and more. If no time information is provided</span>
<span id="cb7-53"><a href="#cb7-53"></a>in one of the arguments <span class="in">`datetime`</span> or <span class="in">`time_column`</span>, the full time series</span>
<span id="cb7-54"><a href="#cb7-54"></a>of pixels with regard to the features are returned. </span>
<span id="cb7-55"><a href="#cb7-55"></a></span>
<span id="cb7-56"><a href="#cb7-56"></a>Pixels with missing values are automatically dropped from the result. It is hence not</span>
<span id="cb7-57"><a href="#cb7-57"></a>guaranteed that the result will contain rows for all input features.</span>
<span id="cb7-58"><a href="#cb7-58"></a></span>
<span id="cb7-59"><a href="#cb7-59"></a>Features are automatically reprojected if the coordinate reference system differs from the data cube.</span>
<span id="cb7-60"><a href="#cb7-60"></a></span>
<span id="cb7-61"><a href="#cb7-61"></a>Extracted values can be aggregated by features by providing a summary function. </span>
<span id="cb7-62"><a href="#cb7-62"></a>If <span class="in">`reduce_time`</span> is FALSE (the default), the values are grouped </span>
<span id="cb7-63"><a href="#cb7-63"></a>by feature and time, i.e., the result will contain unique combinations of FID and time.</span>
<span id="cb7-64"><a href="#cb7-64"></a>To ignore time and produce a single value per feature, <span class="in">`reduce_time`</span> can be set to TRUE.</span>
<span id="cb7-65"><a href="#cb7-65"></a></span>
<span id="cb7-66"><a href="#cb7-66"></a></span>
<span id="cb7-67"><a href="#cb7-67"></a><span class="fu">## Value</span></span>
<span id="cb7-68"><a href="#cb7-68"></a></span>
<span id="cb7-69"><a href="#cb7-69"></a>A data.frame with columns FID, time, and data cube bands / variables</span>
<span id="cb7-70"><a href="#cb7-70"></a></span>
<span id="cb7-71"><a href="#cb7-71"></a></span>
<span id="cb7-72"><a href="#cb7-72"></a><span class="fu">## Examples</span></span>
<span id="cb7-73"><a href="#cb7-73"></a></span>
<span id="cb7-74"><a href="#cb7-74"></a></span>
<span id="cb7-77"><a href="#cb7-77"></a><span class="in">```{r}</span></span>
<span id="cb7-78"><a href="#cb7-78"></a><span class="co"># if not already done in other examples</span></span>
<span id="cb7-79"><a href="#cb7-79"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">"L8.db"</span>))) {</span>
<span id="cb7-80"><a href="#cb7-80"></a>  L8_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">system.file</span>(<span class="st">"L8NY18"</span>, <span class="at">package =</span> <span class="st">"gdalcubes"</span>),</span>
<span id="cb7-81"><a href="#cb7-81"></a>                         <span class="st">".TIF"</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-82"><a href="#cb7-82"></a>  <span class="fu">create_image_collection</span>(L8_files, <span class="st">"L8_L1TP"</span>, <span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">"L8.db"</span>), <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-83"><a href="#cb7-83"></a>}</span>
<span id="cb7-84"><a href="#cb7-84"></a>L8.col <span class="ot">=</span> <span class="fu">image_collection</span>(<span class="fu">file.path</span>(<span class="fu">tempdir</span>(), <span class="st">"L8.db"</span>))</span>
<span id="cb7-85"><a href="#cb7-85"></a>v <span class="ot">=</span> <span class="fu">cube_view</span>(<span class="at">srs=</span><span class="st">"EPSG:32618"</span>, <span class="at">dy=</span><span class="dv">1000</span>, <span class="at">dx=</span><span class="dv">1000</span>, <span class="at">dt=</span><span class="st">"P1M"</span>,</span>
<span id="cb7-86"><a href="#cb7-86"></a>              <span class="at">aggregation =</span> <span class="st">"median"</span>, <span class="at">resampling =</span> <span class="st">"bilinear"</span>,</span>
<span id="cb7-87"><a href="#cb7-87"></a>              <span class="at">extent=</span><span class="fu">list</span>(<span class="at">left=</span><span class="fl">388941.2</span>, <span class="at">right=</span><span class="fl">766552.4</span>,</span>
<span id="cb7-88"><a href="#cb7-88"></a>                          <span class="at">bottom=</span><span class="dv">4345299</span>, <span class="at">top=</span><span class="dv">4744931</span>,</span>
<span id="cb7-89"><a href="#cb7-89"></a>                          <span class="at">t0=</span><span class="st">"2018-01-01"</span>, <span class="at">t1=</span><span class="st">"2018-04-30"</span>))</span>
<span id="cb7-90"><a href="#cb7-90"></a>L8.cube <span class="ot">=</span> <span class="fu">raster_cube</span>(L8.col, v)</span>
<span id="cb7-91"><a href="#cb7-91"></a>L8.cube <span class="ot">=</span> <span class="fu">select_bands</span>(L8.cube, <span class="fu">c</span>(<span class="st">"B04"</span>, <span class="st">"B05"</span>))</span>
<span id="cb7-92"><a href="#cb7-92"></a>L8.ndvi <span class="ot">=</span> <span class="fu">apply_pixel</span>(L8.cube, <span class="st">"(B05-B04)/(B05+B04)"</span>, <span class="st">"NDVI"</span>)</span>
<span id="cb7-93"><a href="#cb7-93"></a>L8.ndvi</span>
<span id="cb7-94"><a href="#cb7-94"></a></span>
<span id="cb7-95"><a href="#cb7-95"></a><span class="cf">if</span> (<span class="fu">gdalcubes_gdal_has_geos</span>()) {</span>
<span id="cb7-96"><a href="#cb7-96"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"sf"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb7-97"><a href="#cb7-97"></a>  </span>
<span id="cb7-98"><a href="#cb7-98"></a>    x <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">20</span>, v<span class="sc">$</span>space<span class="sc">$</span>left, v<span class="sc">$</span>space<span class="sc">$</span>right)</span>
<span id="cb7-99"><a href="#cb7-99"></a>    y <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">20</span>, v<span class="sc">$</span>space<span class="sc">$</span>bottom, v<span class="sc">$</span>space<span class="sc">$</span>top)</span>
<span id="cb7-100"><a href="#cb7-100"></a>    t <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">"2018-01-01"</span>),<span class="fu">as.Date</span>(<span class="st">"2018-04-30"</span>), <span class="at">by =</span> <span class="dv">1</span>),<span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-101"><a href="#cb7-101"></a>    df <span class="ot">=</span> sf<span class="sc">::</span><span class="fu">st_as_sf</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>), <span class="at">crs =</span> v<span class="sc">$</span>space<span class="sc">$</span>srs)</span>
<span id="cb7-102"><a href="#cb7-102"></a></span>
<span id="cb7-103"><a href="#cb7-103"></a>    <span class="co"># spatiotemporal points</span></span>
<span id="cb7-104"><a href="#cb7-104"></a>    <span class="fu">extract_geom</span>(L8.ndvi, df, <span class="at">datetime =</span> t)</span>
<span id="cb7-105"><a href="#cb7-105"></a></span>
<span id="cb7-106"><a href="#cb7-106"></a>    <span class="co"># time series at spatial points</span></span>
<span id="cb7-107"><a href="#cb7-107"></a>    <span class="fu">extract_geom</span>(L8.ndvi, df)</span>
<span id="cb7-108"><a href="#cb7-108"></a>  </span>
<span id="cb7-109"><a href="#cb7-109"></a>    <span class="co"># summary statistics over polygons</span></span>
<span id="cb7-110"><a href="#cb7-110"></a>    x <span class="ot">=</span> sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="fu">system.file</span>(<span class="st">"nycd.gpkg"</span>, <span class="at">package =</span> <span class="st">"gdalcubes"</span>))</span>
<span id="cb7-111"><a href="#cb7-111"></a>    zstats <span class="ot">=</span> <span class="fu">extract_geom</span>(L8.ndvi,x, <span class="at">FUN=</span>median, <span class="at">reduce_time =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-112"><a href="#cb7-112"></a>    zstats</span>
<span id="cb7-113"><a href="#cb7-113"></a>    <span class="co"># combine with original sf object</span></span>
<span id="cb7-114"><a href="#cb7-114"></a>    x<span class="sc">$</span>FID <span class="ot">=</span> <span class="fu">rownames</span>(x)</span>
<span id="cb7-115"><a href="#cb7-115"></a>    x <span class="ot">=</span> <span class="fu">merge</span>(x, zstats, <span class="at">by =</span> <span class="st">"FID"</span>)</span>
<span id="cb7-116"><a href="#cb7-116"></a>    x</span>
<span id="cb7-117"><a href="#cb7-117"></a>    <span class="co"># plot(x["NDVI"])</span></span>
<span id="cb7-118"><a href="#cb7-118"></a>  }</span>
<span id="cb7-119"><a href="#cb7-119"></a>}</span>
<span id="cb7-120"><a href="#cb7-120"></a><span class="in">```</span></span>
<span id="cb7-121"><a href="#cb7-121"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">
        <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2022 Marius Appel
  </li>  
</ul>
      </div>
  </div>
</footer>


</body></html>